{% extends "base.html" %}

{% block title %} Evaluaci√≥n: {{evaluation_instance.title}} {% endblock %}

{% block content %}

<div class="container">
  <h1 class="mb-4 text-primary">Detalles de la Evaluaci√≥n</h1>
  <div class="card shadow-lg p-4">
    <p><strong>Nombre:</strong> {{ evaluation_instance.title }}</p>
    <p><strong>Grupo de Evaluaciones:</strong> {{ evaluation_instance.evaluation.title }}</p>
    <p><strong>Ramo:</strong> {{ evaluation_instance.evaluation.section.course_instance.course.title }} ({{ evaluation_instance.evaluation.section.course_instance.year }}-{{ evaluation_instance.evaluation.section.course_instance.semester }})</p>
    <p><strong>Seccion:</strong> {{ evaluation_instance.evaluation.section.code }}</p>
    <p><strong>Ponderaci√≥n:</strong> {{ evaluation_instance.instance_weighing }}</p>

    <div class="mt-4 d-flex justify-content-between">
      <a href="{{ url_for('evaluation_instance.index') }}" class="btn btn-secondary">
        ‚¨Ö Volver al listado
      </a>
      <div class="btn-group" role="group">
        <a href="{{ url_for('evaluation_instance.edit', id=evaluation_instance.id) }}" class="btn btn-warning text-dark">
          ‚úè Editar
        </a>
        <a href="{{ url_for('evaluation_instance.delete', id=evaluation_instance.id) }}" class="btn btn-danger" onclick="return confirm('¬øEst√°s seguro de que deseas eliminar esta evaluaci√≥n?');">
          üóë Eliminar
        </a>
      </div>
    </div>
  </div>

  <h3 class="mt-5">Calificaciones de estudiantes</h3>
  {% if students %}
    <ul class="list-group">
      {% for student in students %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>{{ student.user.first_name }} {{ student.user.last_name }} {{student.id}}</div>
          {% if student.id in student_grades %}
            if student_grades[student.id] >= 4.0:
              <span class="badge bg-success fs-6">
                {{ student_grades[student.id] }}
              </span>
            else:
              <span class="badge bg-danger fs-6">
                {{ student_grades[student.id] }}
              </span>
            {% else %}
              <span class="badge bg-secondary fs-6">
                {{ student_grades[student.id] }}
              </span>
            {% endif %}
          {% else %}
            <a href="{{ url_for('evaluation_instance.grade_user', evaluation_instance_id=evaluation_instance.id, student_id=student.id) }}" class="btn btn-sm btn-outline-primary ms-2">Calificar</a>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No hay estudiantes</p>
  {% endif %}
</div>

{% endblock %}
